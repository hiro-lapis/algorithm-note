[問題文](https://atcoder.jp/contests/abc305/tasks/abc305_d)

#累積和
#メモ化

## 問題文の把握

- ノートに一連の睡眠記録をつけている。記録は An からなる配列 
- A1=0,, A2, ... An で、奇数は起床時刻、偶数は就寝時刻
  - 1 <= i <= N-1/2 を満たす整数 i についてA2i分後にちょうど寝て、A2i＋1分後に起きた
  - それ以外の時間は寝ることも起きることもなかった
- Q　コの質問が与えられるので回答せよ
  - i 番目の質問では 0 <= li <= ri <= An を満たす整数のペア (li, ri) が与えられる
  - 睡眠記録をつけ初めてから li 分後ちょうど後から ri 分後までの ri - li の時間帯で寝ていた分数は？
  
制約
- 3 <= N < 2 * 10^5
- N は奇数
- 0 = A1 A2 .. An <= 10^9
- 1 <= Q <= 2 *10^5
- 0 <= li <= ri AN


```
N
A1 A2 ... An

Q
l1 r1
l2 r2
lQ rQ

case1
7
0 240 720 1320 1440 1800 2160
3
480 1920
720 1200
0 2160
=> 480 0 960

240 ~ 720 480m
1320 ~ 1440 120m
1800 ~ 2160 360m

l1r1 (480 ~ 1920( の区間で寝ていた時間は、
480 ~ 720 > 240m
1320 ~ 1440 > 120m
1800 ~ 1920  > 120m
total 480m
```

## ロジック

【Query を受けて都度累積話を計算する方法】

・Qの要素をfor文で回して各Q要素の計測期間(開始、終了)を取得
・Qのfor の中でAコの配列を偶数(就寝)・奇数(起床)の２つ単位で取り出し
・計測期間(開始、終了)と、各起床就寝時間を計算し就寝時間を求める

これでも計算はできるが、制約に引っかかってTLEになる

[実際のコード](https://atcoder.jp/contests/abc305/submissions/42152218)

## 計算の効率化

図を見ると、時間の経過に応じて睡眠時間が累積していくのがわかる  
[image](./305.png)

TLEになったコードではループの度に図の紫部分の累積を計算していったが、そもそもこの紫部分はどんなクエリが来ても一定である
Query ごとで異なるのは、Queryによって与えられる 計測開始時間、計測終了時間。

よって、
- 記録上の累積睡眠時間(紫部分のトータル)を、あらかじめ計算しておく
-Queryによって与えられる 計測開始時間、計測終了時間の時間帯に一番近い記録のindexを取得(就寝、起床の2 index)
- 2 index 間の累積睡眠時間を算出
- Queryの端数時間分だけ睡眠時間を足し引き

という風に、累積和を元に睡眠時間を求めることで計算時間を短縮する

### pseudo code

```
```

### tips

time complexity O(n + log(n))

あらかじめ累積和を求める処理が n  
上界を求める処理が log(n)
